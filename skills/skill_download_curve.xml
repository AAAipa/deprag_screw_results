<?xml version="1.0" encoding="UTF-8"?>

<pitasc>
    <models>
        <include package="pitasc_library" file="models/pitasc.xml" />
        <include package="pitasc_library" file="models/skills.xml" />

        <!-- pitasc script model to call the service -->
        <type id="script_download_curve" prototype="script_service_caller">
            <meta>
                <member id="description">Calls a srvs with type 'deprag_downloader/download_request'.</member>
                <member id="categories">io</member>
                <member id="implementation">
                    <clone prototype="orocos">
                        <member id="package">deprag_downloader</member>
                        <member id="component">ScriptRosServiceDownloadCurveRequest</member>
                    </clone>
                </member>
            </meta>
            <data>
                <member id="service_name">/deprag_download</member>
                <type id="download_target" prototype="int_parameter">
                    <meta>
                        <member id="description">Download target;
                            - 0 will download all files available,
                            - 1 will download the lates curve,
                            - a value less than 0 will download the last curve and the corresponding program
                            parameters and publish both under /deprag/curves
                        </member>
                        <member id="visibility">basic</member>
                    </meta>
                    <data>1</data>
                </type>
                <type id="retries" prototype="int_parameter">
                    <meta>
                        <member id="description">Number of retries in case of a failure.</member>
                        <member id="visibility">basic</member>
                    </meta>
                    <data>0</data>
                </type>
            </data>
        </type>

        <!-- pitasc skill model to call the script -->
        <type id="skill_download_curve" prototype="skill_idle_duration">
            <meta>
                <member id="description">TODO: description</member>
            </meta>
            <data>
                <member id="duration">1.0</member>
                <type id="namespace" prototype="string_parameter"></type>
                <type id="download_target" prototype="int_parameter">
                    <data>1</data>
                </type>
                <type id="retries" prototype="int_parameter">
                    <data>0</data>
                </type>
                <member id="scripts">
                    <clone id="request_download" prototype="script_download_curve">
                        <member id="on_start">False</member>
                        <member id="namespace" reference_id="namespace" />
                        <member id="download_target" reference_id="download_target" />
                        <member id="retries" reference_id="retries" />
                    </clone>
                </member>
            </data>
        </type>

    </models>
</pitasc>